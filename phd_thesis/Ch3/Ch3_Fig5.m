% Paper 1 , Fig 3 : title('3dB beamwidth and 3dB sidelobe region of the uniform and
% Gaussian distributions for different R values, N = 16,1024')
%
%  Notes:
% in this figure, note the effect of N on the sidelobe region
% the sidelobe region of the Gaussian distribution is at lerger angle ???

clear;clc
tic
R=10.^[(0:.1:2)];
N1=16;
N2=1024;
V=(R/3).^2;

phi=0:.001:pi;


for cntr=1:length(R)
    % 3-dB beamwidth
    phi_3dB_u(cntr)=(180/pi)*2*asin(0.1286/R(cntr));
    phi_3dB_g(cntr)=(180/pi)*2*asin(0.1988/R(cntr));
    
    % 3-dB sidelobe region for different V - using equation N=16
    n01=ceil(0.25+((2/pi)*(((N1-1)/pi)^(1/3))));
    phi_SL_u1(cntr)=(180/pi)*2*asin((n01+0.25)/(4*R(cntr)));
    phi_SL_g1(cntr)=(180/pi)*2*asin(        (sqrt(log(N1-1)))        /        (4*pi*sqrt(V(cntr)))        );
    
    % 3-dB sidelobe region for different V - using equation N= 1024
    n02=ceil(0.25+((2/pi)*(((N2-1)/pi)^(1/3))));
    phi_SL_u2(cntr)=(180/pi)*2*asin((n02+0.25)/(4*R(cntr)));
    phi_SL_g2(cntr)=(180/pi)*2*asin(        (sqrt(log(N2-1)))        /        (4*pi*sqrt(V(cntr)))        );
end

x1=R;
y1=phi_3dB_u;
y2=phi_SL_u1;
y3=phi_SL_u2;
y4=phi_3dB_g;
y5=phi_SL_g1;
y6=phi_SL_g2;


%save Ch3_Fig5



%% Create figure
figure1 = figure;

%% Create axes
axes1 = axes(...
    'YTick',[0 60 120 180],...
    'YTickLabel',{'0','60','120','180'},...
    'Parent',figure1);
ylim(axes1,[0 180]);
grid(axes1,'on');





%% Create semilogx
semilogx4 = semilogx(...
    x1,y4,...
    'LineStyle','none',...
    'Marker','d',...
    'Color','k',...
    'Parent',axes1);
hold
%% Create semilogx
semilogx5 = semilogx(...
    x1,y5,...
    'LineStyle','none',...
    'Marker','x',...
    'Color','k',...
    'Parent',axes1);

%% Create semilogx
semilogx6 = semilogx(...
    x1,y6,...
    'Marker','o',...
    'LineStyle','none',...
    'Color','k',...
    'Parent',axes1);


%% Create semilogx
semilogx1 = semilogx(...
    x1,y1,...
    'Color','k',...
    'LineStyle','-.',...
    'Marker','d',...
    'Parent',axes1,...
    'DisplayName','3dB Beamwidth');



%% Create semilogx
semilogx2 = semilogx(...
    x1,y2,...
    'LineStyle','-.',...
    'Color','k',...
    'Marker','x',...
    'Parent',axes1,...
    'DisplayName','3dB sideobe region, N=16');

%% Create semilogx
semilogx3 = semilogx(...
    x1(2:end),y3(2:end),...
    'LineStyle','-.',...
    'Color','k',...
    'Marker','o',...
    'Parent',axes1,...
    'DisplayName','3dB sideobe region, N=1024');

%% Create semilogx
semilogx4 = semilogx(...
    x1,y4,...
    'LineStyle','-',...
    'Marker','d',...
    'Color','k',...
    'Parent',axes1);

%% Create semilogx
semilogx5 = semilogx(...
    x1,y5,...
    'LineStyle','-',...
    'Marker','x',...
    'Color','k',...
    'Parent',axes1);

%% Create semilogx
semilogx6 = semilogx(...
    x1,y6,...
    'Marker','o',...
    'LineStyle','-',...
    'Color','k',...
    'Parent',axes1);

grid(axes1,'on');

% Create line
annotation(figure1,'line',[0.542857142857143 0.707142857142857],...
    [0.575190476190476 0.573809523809524],'LineStyle','-.');

% Create line
annotation(figure1,'line',[0.541428571428571 0.710714285714286],...
    [0.488523809523811 0.488095238095238]);

% Create textbox
annotation(figure1,'textbox',...
    [0.715642857142857 0.434761904761907 0.172214285714286 0.0857142857142864],...
    'String',{'Gaussian'},...
    'FitBoxToText','off',...
    'LineStyle','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.722428571428571 0.51904761904762 0.172214285714286 0.0857142857142864],...
    'String',{'Uniform'},...
    'FitBoxToText','off',...
    'LineStyle','none');



%% Create legend
legend1 = legend(    axes1,{'\phi_{3dB}','\phi_{SL}, N=16','\phi_{SL}, N=1024'});

xlabel(axes1,'Normalized Radius R/\lambda = 3\sigma');
ylabel(axes1,'Angle \phi [degree]');

